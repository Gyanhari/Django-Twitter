{% extends 'adminBase.html' %}
{% load static %}

{% block title %}
Home - SISS
{% endblock %}

{% block style %}
<style>
    table {
        width: 100vh;
        border-collapse: collapse;
    }
    th, td {
        padding: 8px;
        text-align: left;
        border-bottom: 1px solid #ddd;
    }
    th {
        background-color: #f2f2f2;
    }

    img {
        max-width: 100px;
        max-height: 100px;
        cursor: pointer;
    }
    td a{
        text-decoration: none;
        color: black;
    }
</style>
{% endblock style %}

{% block rightcontainer %}
<div class="maincontainer">
<h1>Pending Posts for Approval</h1>
<div>
    <table>
        <thead>
            <tr>
                <th>SN</th>
                <th>User</th>
                <th>Caption</th>
                <th>Post</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for post in pending_posts %}
            <tr>
                <td>{{ forloop.counter }}</td> <!-- Display serial number -->
                <td><a href="{% url 'post_details' post.id %}">{{ post.user|title }}</a>  </td> <!-- Display user -->
                <td><a href="{% url 'post_details' post.id %}">{{ post.caption }}</a>   </td> <!-- Display caption -->
                <!-- Check if post has an image -->
                <td>
                    {% if post.image %}
                    <a href="{{ post.image.url }}" target="_blank">
                        <img src="{{ post.image.url }}" alt="Post Image">
                    </a>
                    {% else %}
                    No Image
                    {% endif %}
                </td>
                <!-- Display buttons for approval or deletion -->
                <td>
                    <form action="{% url 'admin_approval' %}" method="post">
                        {% csrf_token %}
                        <input type="hidden" name="post_id" value="{{ post.id }}">
                        <button type="submit" name="action" value="approve">Approve</button>
                        <button type="submit" name="action" value="reject">Delete</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<h1>Approved Posts</h1>
<div>
    <table>
        <thead>
            <tr>
                <th>SN</th>
                <th>User</th>
                <th>Caption</th>
                <th>Post</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            {% for post in approved_posts %}
            <tr>
                <td>{{ forloop.counter }}</td> <!-- Display serial number -->
                <td><a href="{% url 'post_details' post.id %}">{{ post.user|title }}</a></td> <!-- Display user -->
                <td><a href="{% url 'post_details' post.id %}">{{ post.caption }}</a></td> <!-- Display caption -->
                <!-- Check if post has an image -->
                <td>
                    {% if post.image %}
                    <a href="{{ post.image.url }}" target="_blank">
                        <img src="{{ post.image.url }}" alt="Post Image">
                    </a>
                    {% else %}
                    No Image
                    {% endif %}
                </td>
                <!-- Display delete button for approved posts -->
                <td>
                    <form action="{% url 'admin_approval' %}" method="post">
                        {% csrf_token %}
                        <input type="hidden" name="post_id" value="{{ post.id }}">
                        <button type="submit" name="action" value="reject">Delete</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

{% endblock rightcontainer %}
